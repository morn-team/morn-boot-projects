<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cipher 消息加密 | MornBoot 中文文档</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="MornBoot是基于SpringBoot的标准API框架，致力于为JavaWeb项目提供标准化API。">
    <link rel="preload" href="/morn-boot-projects/assets/css/0.styles.365c04f4.css" as="style"><link rel="preload" href="/morn-boot-projects/assets/js/app.d19d48d1.js" as="script"><link rel="preload" href="/morn-boot-projects/assets/js/2.b4b84c12.js" as="script"><link rel="preload" href="/morn-boot-projects/assets/js/9.aa94bbfc.js" as="script"><link rel="prefetch" href="/morn-boot-projects/assets/js/10.fae0c8a9.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/11.94c00f0d.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/12.9448ca34.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/13.ae6a9fca.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/14.a53c3760.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/15.75aed8cd.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/16.a05d08ea.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/17.f038f1d1.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/18.cc6fc2b7.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/19.e566f1a2.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/20.c6c74575.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/21.fb8cebbf.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/3.e0637fce.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/5.f82cfa2b.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/6.9f5c410b.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/7.40fc9a12.js"><link rel="prefetch" href="/morn-boot-projects/assets/js/8.1c189c44.js">
    <link rel="stylesheet" href="/morn-boot-projects/assets/css/0.styles.365c04f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/morn-boot-projects/" class="home-link router-link-active"><!----> <span class="site-name">MornBoot 中文文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/morn-team/morn-boot-projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/morn-team/morn-boot-projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/morn-boot-projects/guide/" class="sidebar-link">介绍</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Specification 规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>CRUD 搬砖</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/morn-boot-projects/cache-group.html" class="sidebar-link">CacheGroup 分组缓存</a></li><li><a href="/morn-boot-projects/cipher.html" aria-current="page" class="active sidebar-link">Cipher 消息加密</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/morn-boot-projects/cipher.html#必要配置" class="sidebar-link">必要配置</a></li><li class="sidebar-sub-header"><a href="/morn-boot-projects/cipher.html#aes" class="sidebar-link">AES</a></li><li class="sidebar-sub-header"><a href="/morn-boot-projects/cipher.html#bcrypt" class="sidebar-link">BCrypt</a></li><li class="sidebar-sub-header"><a href="/morn-boot-projects/cipher.html#md5" class="sidebar-link">MD5</a></li><li class="sidebar-sub-header"><a href="/morn-boot-projects/cipher.html#other" class="sidebar-link">Other</a></li></ul></li><li><a href="/morn-boot-projects/json.html" class="sidebar-link">JSON 序列化</a></li><li><a href="/morn-boot-projects/params-validation.html" class="sidebar-link">ParamsValidation 参数校验</a></li><li><a href="/morn-boot-projects/persist-function.html" class="sidebar-link">PersistFunction 持久化函数</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Features 特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Framework 框架</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cipher-消息加密"><a href="#cipher-消息加密" class="header-anchor">#</a> Cipher 消息加密</h1> <p>MornBoot提供统一加密组件，主要目的是屏蔽不同算法之间的差异，规避高昂的学习成本。JDK、Spring等框架虽然提供了非常完善的加密算法，但一些较为复杂的算法（例如：AES），则需要大量的时间学习概念和API的使用。</p> <blockquote><p>Since：v1.2.1</p></blockquote> <p>当前支持：</p> <ul><li>AES
<ul><li>ECB</li> <li>GCM</li></ul></li> <li>BCrypt</li> <li>MD5</li></ul> <h2 id="必要配置"><a href="#必要配置" class="header-anchor">#</a> 必要配置</h2> <p>application.properties</p> <div class="language- extra-class"><pre class="language-text"><code>#加密密码(16位字符串)
morn.cipher.password=HZlhUvtwrscvQl2c
</code></pre></div><blockquote><p>在网络安全中，一般来说不会防范有文件读写权限的攻击者，这应该是另一个维度的安全问题。应用中通常只能提高这类攻击者的破译成本，因此建议集成配置中心设置密码。如果对密码的安全要求极高，目前建议继承加密实现类，重写密码的读取方式，在后续版本中，可能会推出密钥的多种读取方式。</p></blockquote> <h2 id="aes"><a href="#aes" class="header-anchor">#</a> AES</h2> <p>默认密钥长度为128位，向量长度为12位。配置参考：<code>CipherProperties</code>。</p> <blockquote><p>根据目前的科学技术，128位的密钥已经达到了暴力破解远远无法承受的地步，比起盲目提高密钥长度，更应该保证的是密钥的安全。</p></blockquote> <p><strong>注意：AES密文均采用Base64编码，将加密后的字节编译为可读文本。</strong></p> <h3 id="aes-ecb"><a href="#aes-ecb" class="header-anchor">#</a> AES-ECB</h3> <p>ECB算法相对简单，没有防篡改功能，适合加密有隐私性，但不重要的数据。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CiphersTest</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 原始文本
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PLAIN_TEXT <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * ECB加密
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAESForECB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加密</span>
    <span class="token class-name">Algorithm</span> algorithm <span class="token operator">=</span> <span class="token class-name">AlgorithmBuilder</span><span class="token punctuation">.</span><span class="token function">withName</span><span class="token punctuation">(</span>AES<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mode</span><span class="token punctuation">(</span>AES_ECB_PKCS5PADDING<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> encrypt <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 解密</span>
    <span class="token class-name">String</span> decrypt <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 校验</span>
    <span class="token keyword">boolean</span> matches <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>密文示例：</p> <div class="language-log extra-class"><pre class="language-text"><code>3Rfxf5ENwbS924owowS9QA==
</code></pre></div><h3 id="aes-gcm"><a href="#aes-gcm" class="header-anchor">#</a> AES-GCM</h3> <p>GCM算法更加复杂，并且验证了完整性、真实性，同时MornBoot几乎屏蔽了ECB和GCM的使用差异（随机向量、连接消息），大部分场景比ECB更加适用。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CiphersTest</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 原始文本
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PLAIN_TEXT <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * GCM加密
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAESForGCM</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加密</span>
    <span class="token class-name">Algorithm</span> algorithm <span class="token operator">=</span> <span class="token class-name">AlgorithmBuilder</span><span class="token punctuation">.</span><span class="token function">withName</span><span class="token punctuation">(</span>AES<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mode</span><span class="token punctuation">(</span>AES_GCM_NO_PADDING<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> encrypt <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 解密</span>
    <span class="token class-name">String</span> decrypt <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 校验</span>
    <span class="token keyword">boolean</span> matches <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>密文示例：</p> <div class="language-log extra-class"><pre class="language-text"><code>AAAADOiw5/1GeSwJpxcM/mcskV9Dkn6DXl1hpFkgTmKdi1uYFMB6XA==
</code></pre></div><h2 id="bcrypt"><a href="#bcrypt" class="header-anchor">#</a> BCrypt</h2> <p>准确来说是SpringBCrypt，是<a href="https://spring.io/projects/spring-security" target="_blank" rel="noopener noreferrer">SpringSecurity<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的默认加密算法，作用类似MD5，通常用于加密登录密码。<a href="https://spring.io/projects/spring-security" target="_blank" rel="noopener noreferrer">SpringSecurity<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>会在加密文本中记录算法标识，与<a href="http://www.mindrot.org/projects/jBCrypt/" target="_blank" rel="noopener noreferrer">BCrypt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>略有差别。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CiphersTest</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 原始文本
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PLAIN_TEXT <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">encryptBCrypt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加密</span>
    <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>SPRING_B_CRYPT<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 匹配</span>
    <span class="token keyword">boolean</span> matches <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>SPRING_B_CRYPT<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">,</span>
        <span class="token string">&quot;{bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>密文示例：</p> <div class="language-log extra-class"><pre class="language-text"><code>{bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG
</code></pre></div><h2 id="md5"><a href="#md5" class="header-anchor">#</a> MD5</h2> <p>信息摘要算法，主要用于防篡改，验证信息完整性。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CiphersTest</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 原始文本
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PLAIN_TEXT <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">encryptMD5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加密</span>
    <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>MD5<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 匹配</span>
    <span class="token keyword">boolean</span> matches <span class="token operator">=</span> <span class="token class-name">Ciphers</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>MD5<span class="token punctuation">,</span> PLAIN_TEXT<span class="token punctuation">,</span> <span class="token string">&quot;5f4dcc3b5aa765d61d8327deb882cf99&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>密文示例：</p> <div class="language-log extra-class"><pre class="language-text"><code>5f4dcc3b5aa765d61d8327deb882cf99
</code></pre></div><h2 id="other"><a href="#other" class="header-anchor">#</a> Other</h2> <p>针对MornBoot尚未收录的算法，或业务项目中的特殊算法，MornBoot也支持自由扩充算法池。</p> <h4 id="扩充加密算法"><a href="#扩充加密算法" class="header-anchor">#</a> 扩充加密算法</h4> <p>使用<code>@AlgorithmName</code>标注算法名称，实现<code>AlgorithmEncryption</code>接口，即可编写自定义算法。同理，实现<code>AlgorithmDecryption</code>接口，即可编写自定义解密算法。</p> <blockquote><p>通常还需要继承<code>SimpleAlgorithmHolder</code>，可以访问<code>Algorithm</code>对象。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@AlgorithmName</span><span class="token punctuation">(</span>SPRING_B_CRYPT<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityBCryptEncryption</span> <span class="token keyword">extends</span> <span class="token class-name">SimpleAlgorithmHolder</span> <span class="token keyword">implements</span> <span class="token class-name">AlgorithmEncryption</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">PasswordEncoderFactories</span><span class="token punctuation">.</span><span class="token function">createDelegatingPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注意通过<code>@Bean</code>/<code>@Component</code>等任意方式注入Spring容器中，使用<code>Ciphers</code>调用加密算法。</p></blockquote> <h3 id="扩充匹配算法"><a href="#扩充匹配算法" class="header-anchor">#</a> 扩充匹配算法</h3> <p>实现方式和加密类似。一般来说，不可逆加密需要将明文加密后与密文匹配；可逆加密则需要将密文解密后与明文匹配，很多可逆加密会参入随机数进行运算。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@AlgorithmName</span><span class="token punctuation">(</span>SPRING_B_CRYPT<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityBCryptMatcher</span> <span class="token keyword">extends</span> <span class="token class-name">SimpleAlgorithmHolder</span> <span class="token keyword">implements</span> <span class="token class-name">AlgorithmMatcher</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> rawText<span class="token punctuation">,</span> <span class="token class-name">CharSequence</span> encodedText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token class-name">PasswordEncoderFactories</span><span class="token punctuation">.</span><span class="token function">createDelegatingPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>rawText<span class="token punctuation">,</span> encodedText<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>相对复杂的示例可以参考AES加密：<code>AESAlgorithms</code></p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/morn-boot-projects/cache-group.html" class="prev">
        CacheGroup 分组缓存
      </a></span> <span class="next"><a href="/morn-boot-projects/json.html">
        JSON 序列化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/morn-boot-projects/assets/js/app.d19d48d1.js" defer></script><script src="/morn-boot-projects/assets/js/2.b4b84c12.js" defer></script><script src="/morn-boot-projects/assets/js/9.aa94bbfc.js" defer></script>
  </body>
</html>
